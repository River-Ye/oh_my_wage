<h1 class="verticalspace">薪資紀錄圖</h1>
<%= form_tag(student_chart_path, method: :get) do %>
  <%= text_field_tag :search, "", placeholder: '請選擇月份', class: "datepicker", "data-provide" => "datepicker" %>
  <%= submit_tag "查詢", class: "btn btn-blue btn-md verticalspace"%>
  <%= link_to "回主選單", student_root_path, class: 'btn btn-gray btn-md' %>
<% end %>


<table class="table col-lg-6 col-md-9 col-lg-12">
  <% @salary.each do |salary| %>
    <tr>
      <td><%= salary.date.strftime("%Y-%m-%d") %></td>
      <td><%= salary.hr %> 時</td>
      <td><%= salary.hourly_wage %> 元</td>
      <td><%= money(salary) %> 元</td>
    </tr>
    <% end %>
    <tr>
      <td>總計</td>
      <td><%= calculate_student_salary_hr %> 時</td>
      <td></td>
      <td><%= calculate_studen_salary_sum %> 元</td>
    </tr>
</table>


<%= line_chart Salary.where('user_id = ?', current_user.id).group_by_month(:date)%>

<script type="text/javascript">
  $(document).on('turbolinks:load', function(){
    $('.datepicker').datepicker({
      language:'zh-TW',
      format: "yyyy-mm",
      viewMode: 'months',
      minViewMode: 'months',
      autoclose: true
    });    
  });
</script>
